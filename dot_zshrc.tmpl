# Version managers (shims set in .zshenv for non-interactive shells)
eval "$(rbenv init - --no-rehash zsh)"

# XDG Base Directory compliance
export HISTFILE="${XDG_STATE_HOME:-$HOME/.local/state}/zsh/history"
mkdir -p "$(dirname "$HISTFILE")"
export ZSH_COMPDUMP="${XDG_CACHE_HOME:-$HOME/.cache}/zsh/zcompdump"
mkdir -p "$(dirname "$ZSH_COMPDUMP")"

export EDITOR="nvim"
export GPG_TTY=$(tty)
export DOCKER_HOST="unix:///${HOME}/.colima/default/docker.sock"
export TESTCONTAINERS_DOCKER_SOCKET_OVERRIDE="/var/run/docker.sock"

# aliases
  alias cat='bat'
  alias d="docker"
  alias dc="docker-compose"
  alias dcr="docker-compose run --rm"
  alias docker_cleanup="docker system prune"
  alias e=$EDITOR
  alias g='git'
  alias k="kubectl"
  alias less="less -R"
  alias lf="less +F"
  alias ll="ls -la"
  alias oc='/Applications/OpenCode.app/Contents/MacOS/opencode-cli'
  alias tf='tofu'
  alias watch='watch -c '

# completions
FPATH=$(brew --prefix)/share/zsh-completions:$FPATH
autoload -Uz compinit && compinit -i -d "$ZSH_COMPDUMP"

# plugins
source $(brew --prefix)/share/zsh-autosuggestions/zsh-autosuggestions.zsh
source $(brew --prefix)/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
eval "$(starship init zsh)"
eval "$(direnv hook zsh)"
[[ -s $(brew --prefix)/etc/profile.d/autojump.sh ]] && source $(brew --prefix)/etc/profile.d/autojump.sh
command -v wt >/dev/null 2>&1 && eval "$(wt config shell init zsh)"
command -v gs >/dev/null 2>&1 && eval "$(gs shell completion zsh)"
[ -s "$HOME/.bun/_bun" ] && source "$HOME/.bun/_bun"

export PATH="$HOME/.local/bin:$HOME/bin:$PATH"

# Enable reverse search (ctrl-r)
bindkey '^R' history-incremental-search-backward

# bun
export BUN_INSTALL="$HOME/.bun"
export PATH="$BUN_INSTALL/bin:$PATH"

# opencode
export PATH={{ .chezmoi.homeDir }}/.opencode/bin:$PATH
