# Odin Linear Issues Poll Configuration
#
# Polls for Linear issues assigned to me that are "In Progress"
# and creates devcontainer sessions with OpenCode to work on them.
#
# Requires LINEAR_API_KEY in environment (set in ~/.env)

id: odin-linear
enabled: true

# Query Linear GraphQL API for in-progress issues assigned to me in 0DIN-Devs team
fetch_command: |
  curl -s -X POST https://api.linear.app/graphql \
    -H "Content-Type: application/json" \
    -H "Authorization: $LINEAR_API_KEY" \
    -d '{"query": "{ viewer { assignedIssues(filter: { state: { name: { eq: \"In Progress\" } }, team: { name: { eq: \"0DIN-Devs\" } } }) { nodes { id identifier title description url branchName } } } }"}' \
    | jq '[.data.viewer.assignedIssues.nodes[] | {id, identifier, title, description, url, branch: .branchName}]' 2>/dev/null || echo '[]'

item_mapping:
  key: '.identifier'
  id: '.id'
  identifier: '.identifier'
  title: '.title'
  description: '.description // ""'
  url: '.url'
  branch: '.branch // ("odin-" + .identifier)'

repo_paths:
  "0din-ai/odin": "~/Documents/GitHub/odin"

default_repo: "0din-ai/odin"

prompt:
  template: |
    Work on Linear issue {identifier}: {title}
    {url}

    {description}

session:
  name_template: "ocdc-odin-{identifier}"
